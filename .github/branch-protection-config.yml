# Branch Protection Configuration
# This file defines the branch protection rules for the repository
# These rules can be applied via the GitHub API using the provided scripts

branch_protection:
  # Branch name pattern to protect
  branch: main
  
  # Required status checks configuration
  required_status_checks:
    # Require branches to be up to date before merging
    strict: true
    # List of required status checks (must match GitHub Actions job names)
    contexts:
      - "WordPress Coding Standards"
      - "PHP Compatibility Check"
      - "Markdown Lint"
  
  # Enforce all configured restrictions for administrators
  enforce_admins: true
  
  # Pull request review requirements
  required_pull_request_reviews:
    # Dismiss stale pull request approvals when new commits are pushed
    dismiss_stale_reviews: true
    # Require approval from code owners (if CODEOWNERS file exists)
    require_code_owner_reviews: false
    # Number of required approving reviews before merging
    required_approving_review_count: 1
    # Require approval of the most recent reviewable push
    require_last_push_approval: true
  
  # No push restrictions (null means anyone with push access can push via PR)
  restrictions: null
  
  # Require a linear history (no merge commits)
  required_linear_history: true
  
  # Do not allow force pushes to this branch
  allow_force_pushes: false
  
  # Do not allow deletion of this branch
  allow_deletions: false
  
  # Require conversation resolution before merging
  required_conversation_resolution: true
  
  # Block creation of matching branches (optional)
  block_creations: false
  
  # Lock branch (prevents all changes) - typically false
  lock_branch: false

# Additional notes:
# - Status check names must exactly match the job names in .github/workflows/code-quality.yml
# - Enforce admins means even repository administrators must follow these rules
# - Linear history prevents merge commits and requires squash/rebase merging
# - Force pushes are disabled to prevent history rewriting
# - Deletions are disabled to prevent accidental branch removal
